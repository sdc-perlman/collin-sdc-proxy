(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=require("@babel/runtime/helpers/asyncToGenerator");var n=e.n(t);const a=require("@babel/runtime/regenerator");var r=e.n(a);const c=require("express");var l=e.n(c);const s=require("axios");var i=e.n(s);const o=require("react");var m=e.n(o);const u=require("react-dom/server"),p=require("fs");var d=e.n(p);const b=require("@babel/runtime/helpers/slicedToArray");var v=e.n(b);const E=function(){return m().createElement("div",{className:"nb-container"},m().createElement("div",{className:"nb-grid"},m().createElement("div",{className:"nb-photo-container"}),m().createElement("div",{className:"nb-description-container"},m().createElement("div",null,m().createElement("h3",null),m().createElement("p",{className:"light-text bold-text"})),m().createElement("div",{className:"light-text small-text bold-text"},m().createElement("ul",{className:"nb-amenities-list"},m().createElement("li",null))))),m().createElement("div",{className:"nb-pricing-container dark-text"},m().createElement("div",{className:"nb-pricing-label bold-text pad-10"},m().createElement("p",null,"Available workspace")),m().createElement("div",{className:"nb-pricing-price pad-10"},m().createElement("p",null,"from ",m().createElement("span",{className:"bolder-text"},"$0/mo")))))},g=function(e){var t=e.location,n=t.workspaceId,a=t.neighborhood,r=t.amenities,c=t.rate,l=t.streetName,s=t.streetNumber,i=e.pic;if(!n)return m().createElement(E,null);function o(e){var t=e.amenities.split(",");if(!r)return m().createElement(m().Fragment,null);var n=t.length-5;return m().createElement(m().Fragment,null,t.map((function(e,t){return m().createElement("li",{key:"".concat(e,"-").concat(t)},"â€¢",e)})),m().createElement("br",null),n>0&&m().createElement("li",null," + ".concat(n," more ")))}return a=a.replace(/\b\w/g,(function(e){return e.toUpperCase()})),m().createElement("div",{className:"nb-container"},m().createElement("a",{href:"/buildings/".concat(n),className:"light-text"},m().createElement("div",{className:"nb-grid"},m().createElement("div",{className:"nb-photo-container"},m().createElement("img",{className:"nb-photo",src:i.url,alt:""})),m().createElement("div",{className:"nb-description-container"},m().createElement("div",null,m().createElement("h3",{className:"nb-description-title "},"".concat(s||""," ").concat(l||"")),m().createElement("p",{className:"light-text bold-text"},a||"")),m().createElement("div",{className:"light-text small-text bold-text"},m().createElement("ul",{className:"nb-amenities-list"},m().createElement(o,{amenities:r}))))),m().createElement("div",{className:"nb-pricing-container dark-text"},m().createElement("div",{className:"nb-pricing-label bold-text pad-10"},m().createElement("p",null,"Available workspace")),m().createElement("div",{className:"nb-pricing-price pad-10"},c?m().createElement("p",null,"from ",m().createElement("span",{className:"bolder-text"},"$".concat(c.slice(0,3),"/mo"))):m().createElement("p",null,"View Inventory")))))},f=function(){return m().createElement("div",null,m().createElement("h3",{className:"nb-section-title"},"Nearby Buildings"))},h=function(e){var t=e.nearbyWorkspaces,a=m().useState(t?t.nearbyWorkspaces:[]),c=v()(a,2),l=c[0],s=c[1],i=m().useState(t?t.photos:[]),o=v()(i,2),u=o[0],p=o[1];return m().useEffect(n()(r().mark((function e(){var t,n,a,c,i,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.length){e.next=21;break}if(t=window.location.pathname.split("/").filter((function(e){return e})),n=t[t.length-1],e.prev=3,!Number.isNaN(n)){e.next=6;break}throw new Error("no id");case 6:return axios.defaults.timeout=3e3,e.next=9,axios.get("".concat("/api/nearbyworkspaces","/buildings/").concat(n));case 9:a=e.sent,c=a.data,i=c.nearbyWorkspaces,o=c.photos,s(i),p(o),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),console.log(e.t0),s(!1);case 21:case"end":return e.stop()}}),e,null,[[3,17]])}))),[]),null===l||!1===l||0===l.length?m().createElement(m().Fragment,null):m().createElement(m().Fragment,null,m().createElement(f,null),l.map((function(e){return m().createElement(g,{key:e.workspaceId,location:e,pic:u})})))},N=function(e){var t=e.nearbyWorkspaces;return m().createElement(h,{nearbyWorkspaces:t})};var x=l()();x.use(l().static("public")),x.use("/buildings/:id",(function(e,t){var a=e.params.id;d().readFile("server/index.html","utf8",function(){var e=n()(r().mark((function e(n,c){var l,s,o,p;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return console.log(n),e.abrupt("return",t.status(n.status||500).send({success:!1,status:n.status||500,message:n.message}));case 5:return e.prev=5,e.next=8,i().get("http://localhost:5001/api/nearbyworkspaces/buildings/"+a);case 8:return l=e.sent,s=l.data,o=(0,u.renderToString)(m().createElement(N,{initialData:s})),p=c.replace('<div id="nearby"></div>','<div id="nearby">'.concat(o,"</div>")),e.abrupt("return",t.send(p.replace('<script defer="defer" id="global"><\/script>','<script defer="defer" id="global">window.initial_data = '.concat(JSON.stringify(s),"<\/script>"))));case 15:e.prev=15,e.t0=e.catch(5),console.log(e.t0),t.send(c);case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,n){return e.apply(this,arguments)}}())})),x.listen(6002,(function(){console.log("listening on port ".concat(6002))}))})();